\section{Calcolo differenziale per funzioni reali di più variabili}
Nella precedente sezione è stato introdotto il concetto di intorno sferico di centro e raggio; ebbene, c'è un tipo per tutti i gusti.
\par Di base, sia l'intervallo $E \subseteq \mathbb{R}^n$. Un punto $x_0 \in \mathbb{R}^n$ si può dire:
\begin{itemize}
	\item \textbf{Interno ad $E$}, se $\exists U_r(x_0)\subseteq E$
	\item \textbf{Esterno ad $E$}, se $\exists U_r(x_0)\subseteq \mathbb{R}^n/E$
	\item \textbf{Di frontiera per $E$}, se $\forall U_r(x_0)\implies(U_r(x_0) \cap E \neq \emptyset) \land (U_r(x_0)\cap \mathbb{R}^n/E \neq \emptyset)$
\end{itemize}
\noindent Diremo poi che l'insieme dei punti interni all'intervallo è la \textbf{parte interna di $E$}, per quelli esterni è il \textbf{bordo di $E$}, mentre l'unione dell'intervallo con il suo bordo è la \textbf{chiusura di $E$}.\par 
Inoltre un insieme si dice \textbf{aperto} quando ogni suo punto è ad esso interno, mentre chiamiamo \textbf{chiuso} un insieme il cui complementare è aperto. Le operazioni fra insiemi effettuate con insiemi dello stesso tipo, non lo modificheranno. Infine, data una funzione $f:\mathbb{R}^n\to \mathbb{R}$ continua nel suo insieme di definizione (in questo caso $\mathbb{R}^n$) abbiamo che questi sono gli insiemi aperti:
\begin{center}
	$\{x \in \mathbb{R}^n:f(x) > 0\}$, $\{x \in \mathbb{R}^n:f(x) < 0\}$, $\{x \in \mathbb{R}^n:f(x) \neq 0\}$
\end{center}
\noindent E questi i chiusi:
\begin{center}
	$\{x \in \mathbb{R}^n:f(x) \geq 0\}$, $\{x \in \mathbb{R}^n:f(x) \leq 0\}$, $\{x \in \mathbb{R}^n:f(x) = 0\}$
\end{center}
\noindent Infine, se la funzione presa in esame è continua, avremo che gli insiemi di livello di una funzione a più variabili $f(x,y)$ saranno del tipo $f(x,y) = c$ e saranno, secondo le forme appena viste, chiusi.

\subsection{Derivate parziali, derivabilità, piano tangente}
In analisi 1 è stato definito il concetto di derivata come il limite del rapporto incrementale, il quale risulta essere allo stesso tempo anche il coefficiente angolare della retta tangente alla funzione che si sta esaminando.\par 
Lavorare in più dimensioni comporta la necessità di espandere questo concetto; anzitutto è necessario introdurre alcuni concetti:
\begin{definition}
	\textbf{Derivate parziali}\par 
	\noindent Sia una funzione $f:\mathbb{R}^n \to \mathbb{R}$, è possibile calcolare le derivate in funzione delle rispettive variabili in un punto $(x_0,y_0)$. Chiamiamo infatti:
	\begin{itemize}
		\item \textbf{Derivata parziale rispetto ad $x$}: \[\dfrac{\partial f}{\partial x}(x_0,y_0) = \lim_{h \to 0}\dfrac{f(x_0+h, y_0) - f(x_0,y_0)}{h}\]
		\item \textbf{Derivata parziale rispetto ad $y$}: \[\dfrac{\partial f}{\partial y}(x_0,y_0) = \lim_{k \to 0}\dfrac{f(x_0, y_0+k) - f(x_0,y_0)}{k}\]
	\end{itemize}
\end{definition}
\begin{definition}
	\textbf{Gradiente}\par 
	\noindent Chiamiamo gradiente di $f$ nel punto $(x_0,y_0)$ il vettore che ha come elementi le derivate parziali della funzione presa in esame e si denota come: \[\nabla f(x_0,y_0) = \left(\dfrac{\partial f}{\partial x}(x_0,y_0), \dfrac{\partial f}{\partial y}(x_0,y_0)\right)\]
\end{definition}
\noindent Tengo a portare all'attenzione il fatto che per calcolare le derivate parziali, le variabili $x_0+h$ e $y_0+k$ devono necessariamente essere all'interno del dominio di funzione; ciò risulta vero se il dominio è aperto.\par 
Possiamo quindi dire che una funzione è derivabile in un punto del suo dominio e là esistono tutte le derivate parziali.

% TODO ----- Inserisci esempio di calcolo derivate parziali
\begin{eg}
	\textbf{Calcolo delle derivate parziali di una funzione}\par 
	\noindent
\end{eg}
\noindent Lo scopo di calcolare la derivata di funzione è l'approssimazione della stessa localmente; abbiamo visto che in una dimensione, lavorando con curve piane, la derivata sarà il coefficiente angolare della retta ad esse tangente. Per pattern recognition, è chiaro che se si lavora in più variabili avremo una superficie la cui derivata sarà un \textbf{piano tangente}.\par 
Nello specifico, immaginiamoci di avere una funzione che dia una \textbf{superficie} $z = f(x,y)$ e di sezionarla con un \textbf{piano verticale} $y = y_0$. Otterremo una curva data da $z = f(x,y_0)$, dalla quale troveremo la retta tangente $r_1$. Ripetiamo lo stesso processo con un \textbf{piano orizzontale} $x = x_0$ per ottenere la tangente $r_2$. Avremo quindi che le due equazioni delle tangenti sono date da:
\begin{center}
	$r_1 = \begin{cases}
		z = f(x_0,y_0) + \dfrac{\partial f}{\partial x}(x_0, y_0)(x-x_0)\\
		y = y_0
	\end{cases}$ $r_2 = \begin{cases}
		z = f(x_0,y_0) + \dfrac{\partial f}{\partial y}(x_0, y_0)(y-y_0)\\
		x = x_0
	\end{cases}$
\end{center}
\noindent E quindi, in definitiva, il \textbf{piano tangente} sarà della seguente forma:
\begin{center}
	$z = f(x_0, y_0) + \dfrac{\partial f}{\partial x}(x_0, y_0)(x-x_0) + \dfrac{\partial f}{\partial y}(x_0, y_0)(y-y_0)$
\end{center}
\noindent Tutto molto bello, tuttavia la derivabilità non ha lo stesso rigore che aveva in analisi 1; infatti non implica né continuità, né l'esistenza del piano tangente. Non è quindi in grado di approssimare sempre la funzione in esame localmente; quindi necessitiamo di un concetto molto più forte: la \textbf{differenziabilità}.

\subsection{Differenziabilità, derivate direzionali}
Riportiamo alla memoria il concetto di \textbf{o piccolo}; si tratta di un'identità che vede l'incremento di una funzione uguale al differenziale della stessa, sommato da un infinitesimo di ordine superiore. Si traduce nella formula, per $h \to 0$: \[g(t+h)-g(t) = g'(t)h + o(h)\]
\noindent Per il calcolo a più variabili è la stessa identica cosa, solamente in modo più esteso.
\begin{definition}
	\textbf{Differenziabilità}\par 
	\noindent La differenziabilità di una funzione $f$ in un punto $(x_0,y_0)$ è un concetto rigoroso che ne implica derivabilità, continuità ed esistenza del piano tangente nello stesso punto. Vale se per $(h,k)\to(0,0)$ è vera la seguente formula: \[f(x_0+h, y_0+k)-f(x_0,y_0) = \dfrac{\partial f}{\partial x}(x_0, y_0)+h + \dfrac{\partial f}{\partial y}(x_0,y_0)+k + o(\sqrt{h^2+k^2})\]
	\noindent Più precisamente, le componenti della formula sono:
	\begin{itemize}
		\item Incremento della funzione: $f(x_0+h, y_0+k)-f(x_0,y_0)$
		\item Incremento sul piano tangente: $\dfrac{\partial f}{\partial x}(x_0, y_0)+h + \dfrac{\partial f}{\partial y}(x_0,y_0)+k$
		\item Infinitesimo d'ordine superiore: $o(\sqrt{h^2+k^2})$
	\end{itemize}
\end{definition}
\noindent Da questa definizione ne seguono alcune altrettanto utili; per esempio, se la funzione è differenziabile in $(x_0,y_0)$, chiamiamo \textbf{differenziale} di $f$ nello stesso punto l'applicazione lineare $df(x_0,y_0):\mathbb{R}^2\to \mathbb{R}$, definita da $df(x_0,y_0):(h,k)\to \nabla f(x_0,y_0)(h,k)$.\par
Più precisamente $\nabla f(x_0,y_0)(h,k)$ è l'incremento della funzione nel passare dal punto $(x_0,y_0)$ al punto $(x_0+h, y_0+k)$ sul piano tangente alla funzione.\par
Il differenziale è necessario per l'approssimazione dell'incremento della funzione; il processo ha anche un nome: \textbf{linearizzazione}.\newline

\noindent In che modo è possibile verificare se una funzione è o meno differenziabile? Il metodo più semplice risulta essere la \textbf{condizione sufficiente}. Diciamo infatti che se esistono e sono continue le derivate parziali in un intorno $(x_0,y_0)$, allora la funzione sarà ivi differenziabile. Ciò vale anche per intervalli, ed in tal caso $f$ sarà differenziabile in tutti i suoi punti.
% TODO ----- INSERISCI ESEMPIO DI CONTROLLO DIFFERENZIABILITÀ
\begin{eg}
	\textbf{Verifica differenziabilità di funzione}\par 
	\noindent
\end{eg}
\noindent Finora abbiamo calcolato la velocità di crescita delle curve in base alle direzioni degli assi, tuttavia per fare un lavoro completo, è necessario conoscere anche come le funzioni crescono in direzioni diverse. Per farlo basta prendere il rapporto incrementale e valutarlo con uno scalare $t \in \mathbb{R}$. Risulta la seguente scrittura: \[D_vf(x_0) = \lim_{t\to 0}\dfrac{f(x_0+tv)-f(x_0)}{t}\]
\noindent Questa si dice \textbf{derivata direzionale} della funzione rispetto al versore $v$ nel punto $x_0$ e vale a patto che il limite esista e sia finito.\par
In questi termini, le derivate parziali possono essere viste come derivate direzionali corrispondenti ai versori canonici $e_i$; quindi quelli che danno la direzione per ogni dimensione. Nel caso specifico di $\mathbb{R}^2$ diciamo che il versore $v = (cos(\theta), sin(\theta))$, ottenendo una scrittura diversa della definizione: \[D_vf(x_0, y_0) = \lim_{t\to 0}\dfrac{f(x_0+tcos(\theta), y_0+tsin(\theta)) - f(x_0, y_0)}{t}\] \noindent Dove abbiamo inoltre che:
\begin{itemize}
	\item $\dfrac{\partial f}{\partial x}(x_0,y_0) = D_vf(x_0, y_0)$, con $v=i$ e $\theta=0$
	\item $\dfrac{\partial f}{\partial y}(x_0,y_0) = D_vf(x_0, y_0)$, con $v=j$ e $\theta=\dfrac{\pi}{2}$
\end{itemize}
\noindent Un'altra cosa da notare è che tutte le derivate direzionali sono combinazioni lineari delle derivate parziali; non a caso le prime risultano essere un caso più generale delle seconde. Paradossalmente sarebbe possibile usare solo la formula delle direzionali, perché funzionerebbe anche con le direzioni degli assi.\newline

\noindent Introduciamo un nuovo strumento; una formula per il calcolo della derivata direzionale attraverso il gradiente:
\begin{definition}
	\textbf{Formula del gradiente}\par 
	\noindent Sia $f:A\subseteq\mathbb{R}^n\to \mathbb{R}$ una funzione differenziabile nel punto $x_0 \in A$. Allora per ogni versore $v$ esiste la derivata direzionale $D_vf(x_0)$ e vale la seguente identità: \[D_vf(x_0) = \nabla f(x_0)v = \sum_{n}^{i=1}\dfrac{\partial f}{\partial x_i}(x_0)v_i\]
\end{definition}
\noindent Per il caso specifico di due dimensioni abbiamo che per ogni versore vale: \[D_vf(x_0,y_0) = \nabla f(x_0,y_0)v = ||\nabla f(x_0,y_0)||cos(\phi)\]
\noindent Dove $\phi$ è l'angolo compreso fra i vettori $v$ e $\nabla f(x_0,y_0)$, può assumere quindi un valore compreso fra $[-1,1]$. In particolare avremo che:
\begin{itemize}
	\item Se $\phi = \frac{\pi}{2} \lor \phi = \frac{3}{2}\pi$, allora il gradiente sarà uguale a $0$.
	\item Se $\phi = 0$, allora risulterà il modulo (o norma) del gradiente e indica la curva di massima salita.
	\item Se $\phi = -1$, allora risulterà il modulo negativo del gradiente e indica la curva di massima discesa.
\end{itemize}

\subsection{Calcolo delle derivate e derivate di ordine superiore}
Abbiamo finalmente uno sputo di fortuna per quanto riguarda il calcolo di derivate. Valgono infatti le stesse regole viste in analisi 1, solamente adattate dalle dimensioni maggiori; infatti, dati $\alpha, \beta \in \mathbb{R}$:
\begin{itemize}
	\item Regola per la somma: $\nabla(\alpha f + \beta g) = \alpha\nabla f + \beta\nabla g$
	\item Regola per la moltiplicazione: $\nabla(fg) = g\nabla f + f\nabla g$
	\item Regola per la divisione: $\nabla\left(\dfrac{f}{g}\right) = \dfrac{g\nabla f - f\nabla g}{g^2}$
\end{itemize}
\noindent Queste stesse relazioni funzionano anche per i differenziali; mentre per le \textbf{funzioni composte} distinguiamo due casi di studio:
\begin{itemize}
	\item \textbf{Primo caso}; Siano $f:A \subseteq R^n \to R$ e $g:I \subseteq R \to R$. Supponiamo che $h(x) = g(f(x))$ sia una funzione definita in un intorno $U di x_0 \in A$.
	Se la funzione f è differenziabile in $x_0$ e la $g$ è derivabile in $f(x_0)$, allora la seguente funzione composita è differenziabile in $x_0$:
	\[h = g \circ f : U \subseteq R^n \to R\]
	\noindent Si ha inoltre che: $\nabla h(x_0) = g'(f(x_0)) \times \nabla f(x_0)$.
	\item \textbf{Secondo caso}; Siano $r:I \subseteq R \to R^n$ e $f:A \subseteq R^n\to R$. Supponiamo che $g(t) = f(r(t))$ sia definita in un intorno $J$ di $t_0 \in I$.
	Se la funzione r è derivabile in $t_0$ e $f$ è differenziabile in $r(t_0)$, allora la seguente funzione composta è derivabile in $t_0$:
	\[g = f\circ r : J \subseteq R \to R\]
	\noindent Si ha inoltre che: $g'(t_0) = \nabla f(r(t_0)) \times r'(t_0) = \sum_{i = 1}^{n}\frac{\partial f}{\partial x_i} (r(t_0))r(t_i)$.
\end{itemize}

% TODO ----- INSERISCI ESEMPIO PRIMO CASO
% TODO ----- INSERISCI ESEMPIO SECONDO CASO

\noindent Una volta determinate le derivate parziali di una funzione f è possibile che quanto ottenuto sia a sua volta derivabile. Ci è richiesto quindi di calcolare le \textbf{derivate parziali seconde}, se esistono. Queste hanno le seguenti forme:
\[\dfrac{\partial^2f}{\partial x^2} = \dfrac{\partial}{\partial x} \left(\dfrac{\partial f}{\partial x}\right), \dfrac{\partial^2f}{\partial y\partial x} = \dfrac{\partial}{\partial y} \left(\dfrac{\partial f}{\partial x}\right), \dfrac{\partial^2f}{\partial x\partial y} = \dfrac{\partial}{\partial x} \left(\dfrac{\partial f}{\partial y}\right), \dfrac{\partial^2f}{\partial y^2} = \dfrac{\partial}{\partial y} \left(\dfrac{\partial f}{\partial y}\right)\]
\noindent Queste si indicano rispettivamente con $f_{xx}, f_{yx}, f_{xy}, f_{yy}$, ed il concetto è facilmente estendibile al caso n: \[\dfrac{\partial^2 f}{\partial x_j \partial x_i} = \dfrac{\partial}{\partial x_j} \left(\dfrac{\partial f}{\partial x_i}\right)\]

\begin{theorem}
	\textbf{Teorema di Schwarz}\par 
	\noindent Sia una funzione $f:A \subseteq \mathbb{R}^2\to \mathbb{R}$, con $A$ suo insieme di definizione aperto. Supponiamo che le derivate parziali seconde miste esistano in un intorno di un punto $(x,y)$ e siano entrambe ivi continue. Allora queste coincideranno in quel punto. Se le derivate parziali sono continue in tutto $A$, allora coincideranno in tutto l'insieme. Quindi:
	\[f \in C^2(A) \implies f_{xy} = f_{yx}\]
	\noindent Abbiamo di conseguenza se la funzione è di classe due nell'insieme definito:
	\begin{itemize}
		\item Le derivate parziali prime sono differenziabili in $A$.
		\item Le derivate parziali seconde sono continue in $A$.
		\item Le derivate parziali miste sono uguali.
	\end{itemize}
	\noindent Notare che se una funzione presenta derivate miste diverse, necessariamente non sarà di classe due in quell'intervallo.
\end{theorem}

\subsection{Differenziale secondo, matrice hessiana, formula di Taylor del secondo ordine}
Siano una funzione $f:A \subseteq \mathbb{R}^2\to \mathbb{R}$, di classe due su $A$ e un intorno di punto $(x_0,y_0) \in A$. Chiamiamo \textbf{differenziale secondo} di $f$ in $(x_0,y_0)$ la seguente funzione:
\[d^2f(x_0,y_0):(h,k) \to \dfrac{\partial^2 f}{\partial x^2}(x_0,y_0)h^2 + \dfrac{\partial^2 f}{\partial y^2}(x_0,y_0)k^2 + 2\dfrac{\partial^2 f}{\partial x\partial y}(x_0,y_0)hk\]
\noindent La quale somiglia per un motivo a me ignoto al risultato di un quadrato di binomio. In ogni caso, i suoi coefficienti possono essere inseriti in una \textbf{matrice hessiana}, la quale risulterà simmetrica in ogni punto di $A$ se la funzione è in esso di classe due.
\[Hf(x_0,y_0) = \begin{pmatrix}
	f_{xx}(x_0,y_0) & f_{xy}(x_0,y_0)\\
	f_{yx}(x_0,y_0) & f_{yy}(x_0,y_0)
\end{pmatrix}\]

% TODO ----- INSERISCI ESEMPIO USO MATRICE HESSIANA

%

\section{Calcolo differenziale per funzioni di più variabili a valori vettoriali}